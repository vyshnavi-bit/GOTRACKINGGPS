
<!DOCTYPE html>
<html>
<head>
    
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon" href="Images/GoTrackingLogo.jpg" type="image/x-icon">
    <title>GoTracking | Locations</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link href="CustomCSS/font-awesome.css" rel="stylesheet" />
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/AdminLTE.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
   <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css?v=1600">
    <link href="plugins/iCheck/all.css" rel="stylesheet" />
    <link href="plugins/iCheck/minimal/_all.css" rel="stylesheet" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="plugins/datatables/dataTables.bootstrap.css">

      <script src="plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- SlimScroll -->
    <script src="plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <script src="plugins/fastclick/fastclick.min.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/app.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="dist/js/demo.js"></script>
    <script src="plugins/iCheck/icheck.js"></script>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.7/leaflet.js"></script>
    <link href="leaflet/dist/MarkerCluster.css?v=1600" rel="stylesheet" type="text/css" />
    <link href="leaflet/dist/MarkerCluster.Default.css?v=1600" rel="stylesheet" type="text/css" />
    <script src="leaflet/dist/leaflet.markercluster.js" type="text/javascript"></script>
    <script src="leaflet/realworld.388.js" type="text/javascript"></script>
    <link href="leaflet/screen.css?v=1600" rel="stylesheet" type="text/css" />
    <script src="leaflet/leaflet.geocoding.js" type="text/javascript"></script>
    <script src="js/JTemplate.js?v=1002" type="text/javascript"></script>
    <script src="customapp.js?v=2" type="text/javascript"></script>
    <script src="Newjs/markerclusterer_GZ.js?v=1002" type="text/javascript"></script>
     <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyDGYPgYpwZ4ZQCLCAujetDwArlVBC_S9TI&sensor=false"></script>
     <script src="Newjs/markerclusterer.js" type="text/javascript"></script>
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
<!--
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>     <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>-->

     <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
<script src="https://www.amcharts.com/lib/3/serial.js"></script>
<script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
<script src="https://www.amcharts.com/lib/3/themes/light.js"></script>

<script src="https://www.amcharts.com/lib/3/pie.js"></script>

    <script src="Newjs/infobox.js" type="text/javascript"></script>
   <style type="text/css">
        .googleMapcls {
            width: 100%;
            height: 450px;
            position: relative;
            overflow: hidden;
        }
        .form-group
        {
            margin-bottom:0px;
        }
        #chartdiv {
	width		: 100%;
	height		: 500px;
	font-size	: 11px;
}		

#pieChart {
  width: 200px;
  height: 200px;
}	
        .img-msg
        {
            border-radius: 50%;
            color: #FFFFFF;
            height: 25px;
            left: -17px;
            position: relative;
            top: 0;
            width: 25px;
        }
        .noft-red
        {
            background: none repeat scroll 0 0 #EA3F3F;
            border-radius: 26px;
            color: #FFFFFF;
            font-size: 10px;
            left: 25px;
            padding: 0;
            position: absolute;
            text-align: center;
            top: 5px;
            width: 20px;
        }
        .noft-green
        {
            background: none repeat scroll 0 0 #4AC4BC;
            border-radius: 26px;
            color: #FFFFFF;
            font-size: 10px;
            left: 25px;
            padding: 0;
            position: absolute;
            text-align: center;
            top: 5px;
            width: 20px;
        }
    </style>
    <style type="text/css">
        element.style
        {
            background: none repeat scroll 0 0 rgba(0, 0, 0, 0.3);
            border-radius: 3px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            display: block;
            height: 15px;
            position: absolute;
            padding-bottom: 31px;
            top: 9.5%;
            left: 17%;
        }
    </style>
    <script type="text/javascript">

        $(document).ready(function () {
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('#div_distancegraph').css('display', 'none');
            }
            else {
                $('#div_distancegraph').css('display', 'block');
            }
        });

        var googlemap;
        function initialize() {
            var myCenter = new google.maps.LatLng(17.497535, 78.408622);
            var mapProp = {
                center: myCenter,
                zoom: 5,
                panControl: true,
                panControlOptions: {
                    position: google.maps.ControlPosition.RIGHT_TOP
                },
                zoomControl: true,
                zoomControlOptions: {
                    style: google.maps.ZoomControlStyle.LARGE,
                    position: google.maps.ControlPosition.RIGHT_TOP
                },
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            googlemap = new google.maps.Map(document.getElementById("googleMap"), mapProp);
        }

        $(function () {
//////            if (getCookie("login_type") == "") {
//////                window.location = '../Dealer/Dealer_login.html';
//////            }
            initialize();
            InitilizeVehicles();
            //$(".knob").knob({
            //    'min': 0,
            //    'max': 100
            //});
        });

        var ServerDate;
        function InitilizeVehicles() {
            var data = { 'op': 'InitilizeVehicles' };
            var s = function (msg) {
                if (msg) {
                    if (msg == "Error login") {
                        window.location = '../Dealer/Dealer_login.html';
                    }
                    else {
                        BindResults(msg);
                    }
                }
                else {
                }
            };
            var e = function (x, h, e) {
            };
            callHandler(data, s, e);
        }
        function callHandler(d, s, e) {
            $.ajax({
                url: 'Bus.axd',
                data: d,
                type: 'GET',
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                async: true,
                cache: true,
                success: s,
                error: e
            });
        }
        var runningvehicles = [];
        var stoppedvehicles = [];
        var delayvehicles = [];
        var vehicletypes = [];
        var distinctvehs = [];
        var allvehsdata = [];
        var markersArray = [];
        var vehiclenos = [];
        function BindResults(data) {
            distinctvehs = [];
            allvehsdata = data;

            var clientdivs = "";
            clientdivs = '<div class="box box-success"> <div class="box-header with-border"><i class="fa fa-car"></i><h3 class="box-title">Vehicles</h3> <div class="box-tools pull-right"><span class="label label-danger" style="cursor: pointer;margin-right: 5px;" id="spn_showhideaddress" onclick="showhideaddress(this);"><label style="width: 70px;cursor: pointer;">Show Address</label><button type="button" class="btn btn-box-tool" style="color: #fff; font-size: 13px;"><i class="fa fa-map-marker"></i></button></span><span class="label label-success" style="cursor: pointer;" onclick="liveupdate();">Refresh <button type="button" class="btn btn-box-tool" data-widget="refresh" title="Refresh" style="color: #fff; font-size: 13px;"> <i class="fa fa-refresh"></i> </button></span><button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-minus"></i> </button> </div></div><div class="box-body"> <div class="table-responsive"> <table class="table no-margin" id="tbl_vehicles"><thead><tr><th>SNo</th><th>Vehicle Number</th><th>Vehicle Type</th><th>Main Power</th><th>Update Status</th><th>Speed (Km/Hr)</th><th>Today Mileage (KMs)</th><th>Address</th></tr></thead><tbody>';
            var cnt = 1;
            vehiclenos = [];
            for (var i = 0; i < data.length; i++) {
                if (vehiclenos.indexOf(data[i].vehicleno) == -1) {
                    clientdivs += '<tr id=' + data[i].vehicleno + ' onclick="onvehrow_click(this);" style="cursor:pointer;"><td>' + cnt + '</td><td><a>' + data[i].vehicleno + '</a></td><td>' + data[i].vehicletype + '</td><td><span class="text-red" title="OFF"><i class="fa fa-power-off"></i> <b>OFF</b> </span><td> </td><td> <b>0</b> </td><td> <b>0 Kms</b> </td><td> </td></tr>';
                    vehiclenos.push(data[i].vehicleno);
                    cnt++;
                }
            }
            $('#lbl_totdevices').html(vehiclenos.length);
            clientdivs += '</tbody></table></div></div></div>';
            $('#datagrid').append(clientdivs);

            liveupdate();
        }

        var checkedvehicles = [];
        var latlng_pos = [];
        function onvehrow_click(thisid) {
            $('#tbl_vehicles tbody tr').each(function () {
                $(this).css('backgroundColor', '#ffffff');
            });
            $(thisid).css('backgroundColor', '#d5d5d5');
            deleteOverlays();
            latlng_pos = [];
            for (var vehicledata in livedata) {
                var vehicleid = livedata[vehicledata].vehiclenum;
                if (vehicleid == thisid.id) {
                    var vehicleno = livedata[vehicledata].vehiclenum;
                    var speed = livedata[vehicledata].Speed;
                    var angle = livedata[vehicledata].direction;
                    var updatedata = livedata[vehicledata].Datetime;
                    var ignation = livedata[vehicledata].Ignation;
                    var acstatus = livedata[vehicledata].ACStatus;
                    var date = updatedata.split(" ")[0];
                    var time = updatedata.split(" ")[1];
                    var todaymileage = livedata[vehicledata].todaymileage;
                    var myCenter = new google.maps.LatLng(livedata[vehicledata].latitude, livedata[vehicledata].longitude);
                    googlemap.panTo(myCenter);
                    var iconsrc;
                    for (var vehicletype in vehicletypes) {
                        if (vehicletypes[vehicletype].idvehicle_properties == vehicleid) {
                            var VehicleType = vehicletypes[vehicletype].vehicletype;
                        }
                    }
                    var VehicleType = "Car";
                    if (VehicleType == 'Escavator') {
                        iconsrc = "VehicleTypes/" + VehicleType + ".png";
                    }
                    else
                        if (VehicleType == "Roller") {
                            if (speed == 0) {
                                VehicleType = "red" + VehicleType;
                                iconsrc = "VehicleTypes/" + VehicleType + ".png";
                            }
                            else {
                                VehicleType = "green" + VehicleType;
                                iconsrc = "VehicleTypes/" + VehicleType + ".png";
                            }
                        }
                        else {
                            if (VehicleType == "") {
                                VehicleType = "Car";
                            }
                            if (speed == 0) {
                                if (VehicleType == "Truck") {
                                    VehicleType = "Tanker";
                                    VehicleType = "red" + VehicleType;
                                }
                                else {
                                    VehicleType = "red" + VehicleType;
                                }
                            }
                            else {
                                if (VehicleType == "Truck") {
                                    VehicleType = "Tanker";
                                    VehicleType = "green" + VehicleType;
                                }
                                else {
                                    VehicleType = "green" + VehicleType;
                                }
                            }
                            if (angle >= 0 && angle < 22.5) {
                                iconsrc = "VehicleTypes/" + VehicleType + "4.png";
                            }
                            else if (angle >= 22.5 && angle < 45) {
                                iconsrc = "VehicleTypes/" + VehicleType + "5.png";
                            }
                            else if (angle >= 45 && angle < 67.5) {
                                iconsrc = "VehicleTypes/" + VehicleType + "6.png";
                            }
                            else if (angle >= 67.5 && angle < 90) {
                                iconsrc = "VehicleTypes/" + VehicleType + "7.png";
                            }
                            else if (angle >= 90 && angle < 112.5) {
                                iconsrc = "VehicleTypes/" + VehicleType + "8.png";
                            }
                            else if (angle >= 112.5 && angle < 135) {
                                iconsrc = "VehicleTypes/" + VehicleType + "9.png";
                            }
                            else if (angle >= 135 && angle < 157.5) {
                                iconsrc = "VehicleTypes/" + VehicleType + "10.png";
                            }
                            else if (angle >= 157.5 && angle < 180) {
                                iconsrc = "VehicleTypes/" + VehicleType + "11.png";
                            }
                            else if (angle >= 180 && angle < 202.5) {
                                iconsrc = "VehicleTypes/" + VehicleType + "12.png";
                            }
                            else if (angle >= 202.5 && angle < 225) {
                                iconsrc = "VehicleTypes/" + VehicleType + "13.png";
                            }
                            else if (angle >= 225 && angle < 247.5) {
                                iconsrc = "VehicleTypes/" + VehicleType + "14.png";
                            }
                            else if (angle >= 247.5 && angle < 270) {
                                iconsrc = "VehicleTypes/" + VehicleType + "15.png";
                            }
                            else if (angle >= 270 && angle < 292.5) {
                                iconsrc = "VehicleTypes/" + VehicleType + "16.png";
                            }
                            else if (angle >= 292.5 && angle < 315) {
                                iconsrc = "VehicleTypes/" + VehicleType + "1.png";
                            }
                            else if (angle >= 315 && angle < 360) {
                                iconsrc = "VehicleTypes/" + VehicleType + "2.png";
                            }
                            else if (angle >= 360) {
                                iconsrc = "VehicleTypes/" + VehicleType + "3.png";
                            }
                            //                            }
                        }
                    placeMarker(myCenter, iconsrc, vehicleid, speed, vehicleno);
                    latlng_pos.push(myCenter);
                    gethistory(vehicleid, vehicleno)
                }
            }

            var latlngbounds = new google.maps.LatLngBounds();
            if (latlng_pos.length > 1) {
                for (var i = 0; i < latlng_pos.length; i++) {
                    latlngbounds.extend(latlng_pos[i]);
                }
                googlemap.fitBounds(latlngbounds);
            }
            else if (latlng_pos.length == 1) {
                for (var i = 0; i < latlng_pos.length; i++) {
                    latlngbounds.extend(latlng_pos[i]);
                }
                googlemap.fitBounds(latlngbounds);
                googlemap.setZoom(12);
            }
            else {
                googlemap.setCenter(new google.maps.LatLng(17.497535, 78.408622));
                googlemap.setZoom(6);
            }
            $('html, body').animate({
                scrollTop: $("#div_vehicle_graphs").offset().top
            }, 100);
        }

        var infowindows = [];
        var popupcontent = "";
        var showpopup = true;
        var infoWindow = new google.maps.InfoWindow();
        function placeMarker(location, iconsrc, vehicleid, speed, vehicleno) {
            var image = new google.maps.MarkerImage(iconsrc,
            // This marker is 20 pixels wide by 32 pixels tall.
    null,
            // The origin for this image is 0,0.
    new google.maps.Point(0, 0),
            // The anchor for this image is the base of the flagpole at 0,32.
    new google.maps.Point(20, 20)
);
            var marker = new google.maps.Marker({
                position: location,
                map: googlemap,
                center: location,
                zoom: 12,
                icon: image,
                title: vehicleno
            });

            markersArray.push(marker);
            var address;
            geocoder = new google.maps.Geocoder();
            infoWindow.close();
            address = geocoder.geocode({ 'latLng': location }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    if (results.length > 0) {
                        if (results[0]) {
                            address = results[0].formatted_address;

                            var content = "<div style='color:#000;'>VehicleID : " + vehicleno + "<br/>" + "Address : " + address + "<br/>" + "Speed : " + speed + " KMPH<div>";
                            var infowindow = new google.maps.InfoWindow({
                                content: content
                            });

                            google.maps.event.addListener(marker, 'click', function () {
                                infowindow.open(googlemap, marker);
                            });
                        }
                        else {
                            address = "No results";

                            var content = "<div style='color:#000;'>VehicleID : " + vehicleno + "<br/>" + "Address : " + address + "<br/>" + "Speed : " + speed + " KMPH<div>";
                            var infowindow = new google.maps.InfoWindow({
                                content: content
                            });

                            google.maps.event.addListener(marker, 'click', function () {
                                infowindow.open(googlemap, marker);
                            });
                        }
                    }
                    else {
                        address = "No results";

                        var content = "<div style='color:#000;'>VehicleID : " + vehicleno + "<br/>" + "Address : " + address + "<br/>" + "Speed : " + speed + " KMPH<div>";
                        var infowindow = new google.maps.InfoWindow({
                            content: content
                        });

                        google.maps.event.addListener(marker, 'click', function () {
                            infowindow.open(googlemap, marker);
                        });
                    }
                }
                else {
                    address = "No results";

                    var content = "<div style='color:#000;'>VehicleID : " + vehicleno + "<br/>" + "Address : " + address + "<br/>" + "Speed : " + speed + " KMPH<div>";

                    var infowindow = new google.maps.InfoWindow({
                        content: content
                    });

                    google.maps.event.addListener(marker, 'click', function () {
                        infowindow.open(googlemap, marker);
                    });
                }
            });
        }

        // Deletes all markers in the array by removing references to them.
        function deleteOverlays() {
            clearOverlays();
            markersArray = [];
        }

        // Sets the map on all markers in the array.
        function setAllMap(googlemap) {
            for (var i = 0; i < markersArray.length; i++) {
                markersArray[i].setMap(googlemap);
            }
        }

        // Removes the overlays from the map, but keeps them in the array.
        function clearOverlays() {
            setAllMap(null);
        }

        function gethistory(vehicleid, vehicleno) {
            var startdate;
            var enddate;
            var today = new Date();
            var hrs = '00', mnts = '00';
////////            if (getCookie("day_time") != "" && getCookie("day_time") != "00:00:00") {
////////                var prevday = new Date();
////////                var day_time = getCookie("day_time");
////////                var day_time_array = day_time.split(':');
////////                hrs = day_time_array[0];
////////                mnts = day_time_array[1];
////////                prevday.setHours(hrs);
////////                prevday.setMinutes(mnts);
////////                if (prevday > new Date()) {
////////                    prevday.setDate(prevday.getDate() - 1);
////////                }
////////                else {
////////                    today.setDate(today.getDate() + 1);
////////                }
////////                var pdd = prevday.getDate();
////////                var pmm = prevday.getMonth() + 1;
////////                var pyyyy = prevday.getFullYear();
////////                if (pdd < 10) {
////////                    pdd = '0' + pdd;
////////                }
////////                if (pmm < 10) {
////////                    pmm = '0' + pmm;
////////                }

////////                var dd = today.getDate();
////////                var mm = today.getMonth() + 1;
////////                var yyyy = today.getFullYear();
////////                if (dd < 10) {
////////                    dd = '0' + dd;
////////                }
////////                if (mm < 10) {
////////                    mm = '0' + mm;
////////                }
////////                startdate = pyyyy + '-' + pmm + '-' + pdd + 'T' + hrs + ':' + mnts;
////////                enddate = yyyy + '-' + mm + '-' + dd + 'T' + hrs + ':' + mnts;
////////            }
////////            else {
                var dd = today.getDate();
                var mm = today.getMonth() + 1;
                var yyyy = today.getFullYear();
                if (dd < 10) {
                    dd = '0' + dd;
                }
                if (mm < 10) {
                    mm = '0' + mm
                }
                var hrs = today.getHours();
                if (hrs < 10) {
                    hrs = '0' + hrs
                }
                var mnts = today.getMinutes();
                if (mnts < 10) {
                    mnts = '0' + mnts
                }
                startdate = yyyy + '-' + mm + '-' + dd + 'T00:00';
                enddate = yyyy + '-' + mm + '-' + dd + 'T23:59';
//////            }

            //var startdate = 2016 + '-' + 06 + '-' + 28 + 'T00:00';
            //var enddate = 2016 + '-' + 06 + '-' + 28 + 'T23:59';
            var data = { 'op': 'getvehiclesdatareport', 'startdate': startdate, 'enddate': enddate, 'checkedvehicles': vehicleid, 'reporttype': "General Report", 'txtvalue': "", 'mainlocationsno': "", 'mainlocationtext': "", 'requestfrom': 'web' };
            var s = function (msg) {
                if (msg) {
                    if (msg != "Error" && msg.length > 0) {
                        var results = msg;
                        var idvehicle_properties = results[0].VehicleID;
                        var VehicleID = results[0].VehicleID;
                        var TotalDistanceTravelled = results[0].TotalDistanceTravelled;
                        var WorkingHours = results[0].WorkingHours;
                        var MotionHours = results[0].MotionHours;
                        var StationaryHours = results[0].StationaryHours;
                        var MaxSpeed = results[0].MaxSpeed;
                        var AvgSpeed = results[0].AvgSpeed;
                        var IdleTime = results[0].IdleTime;
                        var NoOfStops = results[0].NoOfStops;
                        var ACONTime = results[0].ACONTime;
                        var MainPowerOFFTime = results[0].MainPowerOFFTime;
                        var sno = results[0].sno;
                        //$('#lbl_moving_time').html(MotionHours);
                        //$('#lbl_stoppage_time').html(StationaryHours);
                        //$('#lbl_idling_time').html(IdleTime);
                        $('#lbl_map_vehicle').html(vehicleno);

                        $('#lbl_moving_time_1').html(MotionHours);
                        $('#lbl_stoppage_time_1').html(StationaryHours);
                        $('#lbl_idling_time_1').html(IdleTime);

                        //$("#knob_moving").val(results[0].runningPrcntg);
                        //$("#knob_stopped").val(results[0].StoppedPrcntg);
                        //$("#knob_idle").val(results[0].idlePrcntg);

                        //$('.knob').trigger('change');

                        /* Morris.js Charts */
                        var speedchartdata = [];
                        var distancechartdata = [];
                        var firstodo = 0;
                        var distance = 0;
                        for (var vlogs in results[0].vehlogsclslist) {
                            var idvehicle_properties = results[0].vehlogsclslist[vlogs].idvehicle_properties;
                            var datetime = results[0].vehlogsclslist[vlogs].datetime;
                            var speed = results[0].vehlogsclslist[vlogs].speed;
                            var odometer = results[0].vehlogsclslist[vlogs].odometer;
                            if (vlogs == 0)
                                firstodo = odometer;
                            distance = odometer - firstodo;
                            distance = distance.toFixed(2);
                            speedchartdata.push({ m: datetime, a: speed });
                            distancechartdata.push({ m: datetime, a: distance });
                        }

                        $("#line-chart").html("");
                        $("#distance-chart").html("");
                        $("#pieChart").html("");

                        ////////////////////////                        Morris.Line({
                        ////////////////////////                            element: 'line-chart',
                        ////////////////////////                            data: speedchartdata,
                        ////////////////////////                            xkey: 'm',
                        ////////////////////////                            ykeys: ['a'],
                        ////////////////////////                            labels: ['Speed'],
                        ////////////////////////                            lineColors: ['#efefef'],
                        ////////////////////////                            lineWidth: 2,
                        ////////////////////////                            hideHover: 'auto',
                        ////////////////////////                            gridTextColor: "#fff",
                        ////////////////////////                            gridStrokeWidth: 0.4,
                        ////////////////////////                            pointSize: 0,
                        ////////////////////////                            pointStrokeColors: ["#efefef"],
                        ////////////////////////                            gridLineColor: "#efefef",
                        ////////////////////////                            gridTextFamily: "Open Sans",
                        ////////////////////////                            gridTextSize: 10
                        ////////////////////////                        });

                        var chart = AmCharts.makeChart("line-chart", {
                            "type": "serial",
                            "theme": "light",
                            "marginRight": 40,
                            "marginLeft": 40,
                            "autoMarginOffset": 20,
                            "dataDateFormat": "YYYY-MM-DD",
                            "valueAxes": [{
                                "id": "v1",
                                "axisAlpha": 0,
                                "position": "left",
                                "ignoreAxisWidth": true
                            }],
                            "balloon": {
                                "borderThickness": 1,
                                "shadowAlpha": 0
                            },
                            "graphs": [{
                                "id": "g1",
                                "balloon": {
                                    "drop": true,
                                    "adjustBorderColor": false,
                                    "color": "#ffffff",
                                    "type": "smoothedLine"
                                },
                                "fillAlphas": 0.2,
                                "bullet": "round",
                                "bulletBorderAlpha": 1,
                                "bulletColor": "#FFFFFF",
                                "bulletSize": 5,
                                "hideBulletsCount": 50,
                                "lineThickness": 2,
                                "title": "red line",
                                "useLineColorForBulletBorder": true,
                                "valueField": "value",
                                "balloonText": "<span style='font-size:18px;'>[[value]]</span>"
                            }],
                            "chartCursor": {
                                "valueLineEnabled": true,
                                "valueLineBalloonEnabled": true,
                                "cursorAlpha": 0,
                                "zoomable": false,
                                "valueZoomable": true,
                                "valueLineAlpha": 0.5
                            },
                            "valueScrollbar": {
                                "autoGridCount": true,
                                "color": "#000000",
                                "scrollbarHeight": 50
                            },
                            "categoryField": "date",
                            "categoryAxis": {
                                "parseDates": true,
                                "dashLength": 1,
                                "minorGridEnabled": true
                            },
                            "export": {
                                "enabled": true
                            },
                            "dataProvider": [{
                                "date": "2012-07-27",
                                "value": 13
                            }, {
                                "date": "2012-07-28",
                                "value": 11
                            }, {
                                "date": "2012-07-29",
                                "value": 15
                            },  {
                                "date": "2012-08-31",
                                "value": 33
                            }, {
                                "date": "2012-11-02",
                                "value": 67
                            },  {
                                "date": "2013-01-29",
                                "value": 84
                            }, {
                                "date": "2013-01-30",
                                "value": 81
                            }]
                        });

                        ////////////////////////                        Morris.Line({
                        ////////////////////////                            element: 'distance-chart',
                        ////////////////////////                            data: distancechartdata,
                        ////////////////////////                            xkey: 'm',
                        ////////////////////////                            ykeys: ['a'],
                        ////////////////////////                            labels: ['Distance'],
                        ////////////////////////                            lineColors: ['#efefef'],
                        ////////////////////////                            lineWidth: 2,
                        ////////////////////////                            hideHover: 'auto',
                        ////////////////////////                            gridTextColor: "#fff",
                        ////////////////////////                            gridStrokeWidth: 0.4,
                        ////////////////////////                            pointSize: 0,
                        ////////////////////////                            pointStrokeColors: ["#efefef"],
                        ////////////////////////                            gridLineColor: "#efefef",
                        ////////////////////////                            gridTextFamily: "Open Sans",
                        ////////////////////////                            gridTextSize: 10
                        ////////////////////////                        });


                        var chart = AmCharts.makeChart("distance-chart", {
                            "type": "serial",
                            "theme": "light",
                            "autoMarginOffset": 20,
                            "marginRight": 80,
                            "dataProvider": [{
                                "date": "2009-10-01",
                                "value": 3,
                                "fromValue": 2,
                                "toValue": 5
                            }, {
                                "date": "2009-10-02",
                                "value": 10,
                                "fromValue": 4,
                                "toValue": 6
                            }, {
                                "date": "2009-11-04",
                                "value": 5,
                                "fromValue": 20.8,
                                "toValue": 31.2
                            }],
                            "valueAxes": [{
                                "axisAlpha": 0,
                                "position": "left"
                            }],
                            "graphs": [{
                                "id": "fromGraph",
                                "lineAlpha": 0,
                                "showBalloon": false,
                                "valueField": "fromValue",
                                "fillAlphas": 0
                            }, {
                                "fillAlphas": 0.2,
                                "fillToGraph": "fromGraph",
                                "lineAlpha": 0,
                                "showBalloon": false,
                                "valueField": "toValue"
                            }, {
                                "valueField": "value",
                                "balloonText": "<div style='margin:10px; text-align:left'><span style='font-size:11px'>allowed: [[fromValue]] - [[toValue]]</span><br><span style='font-size:18px'>Value:[[value]]</span></div>",
                                "fillAlphas": 0
                            }],
                            "chartCursor": {
                                "fullWidth": true,
                                "cursorAlpha": 0.05,
                                "valueLineEnabled": true,
                                "valueLineAlpha": 0.5,
                                "valueLineBalloonEnabled": true
                            },
                            "dataDateFormat": "YYYY-MM-DD",
                            "categoryField": "date",
                            "categoryAxis": {
                                "position": "top",
                                "parseDates": true,
                                "axisAlpha": 0,
                                "minHorizontalGap": 25,
                                "gridAlpha": 0,
                                "tickLength": 0,
                                "dateFormats": [{
                                    "period": 'fff',
                                    "format": 'JJ:NN:SS'
                                }, {
                                    "period": 'ss',
                                    "format": 'JJ:NN:SS'
                                }, {
                                    "period": 'mm',
                                    "format": 'JJ:NN'
                                }, {
                                    "period": 'hh',
                                    "format": 'JJ:NN'
                                }, {
                                    "period": 'DD',
                                    "format": 'DD'
                                }, {
                                    "period": 'WW',
                                    "format": 'DD'
                                }, {
                                    "period": 'MM',
                                    "format": 'MMM'
                                }, {
                                    "period": 'YYYY',
                                    "format": 'YYYY'
                                }]
                            },

                            "chartScrollbar": {

                        },

                        "export": {
                            "enabled": true
                        }
                    });

                    chart.addListener("dataUpdated", zoomChart);

                    function zoomChart() {
                        chart.zoomToDates(new Date(2009, 9, 20, 15), new Date(2009, 10, 3, 12));
                    }

                        //-------------
                        //- PIE CHART -
                        //-------------
                        // Get context with jQuery - using jQuery's .get() method.
                        //////////                        var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
                        //////////                        var pieChart = new Chart(pieChartCanvas);
                        //////////                        var PieData = [
                        //////////                          {
                        //////////                              value: results[0].runningPrcntg,
                        //////////                              color: "#00a65a",
                        //////////                              highlight: "#00a65a",
                        //////////                              label: "% Moving"
                        //////////                          },
                        //////////                          {
                        //////////                              value: results[0].StoppedPrcntg,
                        //////////                              color: "#f56954",
                        //////////                              highlight: "#f56954",
                        //////////                              label: "% Stoppage"
                        //////////                          },
                        //////////                          {
                        //////////                              value: results[0].idlePrcntg,
                        //////////                              color: "#f39c12",
                        //////////                              highlight: "#f39c12",
                        //////////                              label: "% Idling"
                        //////////                          }
                        //////////                        ];
                        //////////                        var pieOptions = {
                        //////////                            //Boolean - Whether we should show a stroke on each segment
                        //////////                            segmentShowStroke: true,
                        //////////                            //String - The colour of each segment stroke
                        //////////                            segmentStrokeColor: "#fff",
                        //////////                            //Number - The width of each segment stroke
                        //////////                            segmentStrokeWidth: 1,
                        //////////                            //Number - The percentage of the chart that we cut out of the middle
                        //////////                            percentageInnerCutout: 50, // This is 0 for Pie charts
                        //////////                            //Number - Amount of animation steps
                        //////////                            animationSteps: 100,
                        //////////                            //String - Animation easing effect
                        //////////                            animationEasing: "easeOutBounce",
                        //////////                            //Boolean - Whether we animate the rotation of the Doughnut
                        //////////                            animateRotate: true,
                        //////////                            //Boolean - Whether we animate scaling the Doughnut from the centre
                        //////////                            animateScale: false,
                        //////////                            //Boolean - whether to make the chart responsive to window resizing
                        //////////                            responsive: true,
                        //////////                            // Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
                        //////////                            maintainAspectRatio: false,
                        //////////                            //String - A legend template
                        //////////                            legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>",
                        //////////                            //String - A tooltip template
                        //////////                            tooltipTemplate: "<%=value %> <%=label%>"
                        //////////                        };
                        //////////                        //Create pie or douhnut chart
                        //////////                        // You can switch between pie and douhnut using the method below.
                        //////////                        pieChart.Doughnut(PieData, pieOptions);
                        //-----------------
                        //- END PIE CHART -
                        //-----------------
//                        var runningPrcntg = results[0].runningPrcntg;
                        var chart = AmCharts.makeChart("pieChart", {
                            "type": "pie",
                            "theme": "light",
                            "dataProvider": [{
                                "title": "Moving",
                                "value": 10
                            }, {
                                "title": "Stoppage",
                                "value": 5
                            }, {
                                "title": " Idling",
                                "value": 2
                            }],
                            "titleField": "title",
                            "valueField": "value",
                            "labelRadius": 5,

                            "radius": "42%",
                            "innerRadius": "60%",
                            "labelText": "[[title]]",
                            "export": {
                                "enabled": true
                            }
                        });
                    }
                }
                else {
                }
            };
            var e = function (x, h, e) {
                // $('#BookingDetails').html(x);
            };
            $(document).ajaxStart($.blockUI).ajaxStop($.unblockUI);
            callHandler(data, s, e);
        }

        function drawtodaymileagegraph(todaymileagearry) {
            //-------------
            //- BAR CHART -
            //-------------
            var xlabels = [];
            var yvalues = [];
            var newYarray = [];
            for (var i = 0; i < todaymileagearry.length; i++) {
                if (todaymileagearry[i].todaymileage >= 0 && todaymileagearry[i].todaymileage < 1000) {
                    xlabels.push(todaymileagearry[i].vehiclenum);
                    yvalues.push(todaymileagearry[i].todaymileage);
                    newYarray.push({ 'country': todaymileagearry[i].vehiclenum, 'visits': todaymileagearry[i].todaymileage });
                }
            }
            var chart = AmCharts.makeChart("chartdiv", {
                "type": "serial",
                "theme": "light",
                "dataProvider": newYarray,
                "valueAxes": [{
                    "gridColor": "#FFFFFF",
                    "gridAlpha": 0.2,
                    "dashLength": 0
                }],
                "gridAboveGraphs": true,
                "startDuration": 1,
                "graphs": [{
                    "balloonText": "[[category]]: <b>[[value]]</b>",
                    "fillAlphas": 0.8,
                    "lineAlpha": 0.2,
                    "type": "column",
                    "valueField": "visits"
                }],
                "chartCursor": {
                    "categoryBalloonEnabled": false,
                    "cursorAlpha": 0,
                    "zoomable": false
                },
                "categoryField": "country",
                "categoryAxis": {
                    "gridPosition": "start",
                    "gridAlpha": 0,
                    "tickPosition": "start",
                    "tickLength": 10,
                    "labelRotation": 65
                },
                "seriesColors": ["#FF00FF", "#0041C2", "#800517"],
                "export": {
                    "enabled": true
                }

            });
        }

        function liveupdate() {
            $("#tbl_vehicles tbody tr").each(function () {
                if (this.cells.length > 1) {
                    this.cells[3].innerHTML = "";
                    this.cells[4].innerHTML = "";
                    this.cells[5].innerHTML = "";
                    this.cells[6].innerHTML = "";
                    this.cells[7].innerHTML = "";
                }
            });

            var data = { 'op': 'LiveUpdate' };
            var s = function (msg) {
                if (msg) {
                    drawtodaymileagegraph(msg.vehiclesupdatelist);
                    var date = msg.ServerDt.split(" ")[0];
                    var time = msg.ServerDt.split(" ")[1];
                    var datevalues = new Array();
                    var timevalues = new Array();
                    datevalues = date.split('/');
                    timevalues = time.split(':');
                    ServerDate = new Date(datevalues[2], datevalues[1] - 1, datevalues[0], timevalues[0], timevalues[1], timevalues[2]);
                    BindUpdate(msg.vehiclesupdatelist, ServerDate);
                }
                else {
                }
            };
            var e = function (x, h, e) {
                // $('#BookingDetails').html(x);
            };
            callHandler(data, s, e);
        }

        var livedata = null;
        var isgridinit = false;
        function BindUpdate(data, ServerDt) {
            livedata = data;
            $("#tbl_vehicles tr").each(function () {
                for (var vehicledata in data) {
                    var vehicleid = data[vehicledata].vehiclenum;
                    if (vehicleid == this.id) {
                        var vehicleno = data[vehicledata].vehiclenum;
                        var vehicle = $('#VehiclesTable').find("#" + data[vehicledata].vehiclenum + "");
                        var mainpower = data[vehicledata].mainpower;
                        var latitude = data[vehicledata].latitude;
                        var longitude = data[vehicledata].longitude;
                        var angle = data[vehicledata].direction;
                        var updatedata = data[vehicledata].Datetime;
                        var speed = data[vehicledata].Speed;
                        var odometervalue = data[vehicledata].odometervalue;
                        var gps = data[vehicledata].GPSSignal;
                        var geofence = data[vehicledata].Geofence;
                        var todaymileage = data[vehicledata].todaymileage;
                        var dieselstring = data[vehicledata].dieselvalue;
                        var fulltankval = data[vehicledata].fulltankval;
                        if (mainpower == "ON") {
                            this.cells[3].innerHTML = "<span class='text-green' title='ON'><i class='fa fa-power-off'></i> <b>ON</b> </span>";
                        }
                        else {
                            this.cells[3].innerHTML = "<span class='text-red' title='OFF'><i class='fa fa-power-off'></i> <b>OFF</b> </span>";
                        }
                        if (speed > 0) {
                            var mainpowericon = vehicle.closest('tr').find('#imgspeed');
                            mainpowericon.attr("src", "../LiveIcons/State1.png");
                            mainpowericon.attr('title', "Speed : " + speed + " Kms/Hr");
                            this.cells[5].innerHTML = "<span class='text-green' title='" + speed + " Km/Hr'> <b>" + speed + "</b> </span>";
                        }
                        else {
                            var mainpowericon = vehicle.closest('tr').find('#imgspeed');
                            mainpowericon.attr("src", "../LiveIcons/State3.png");
                            mainpowericon.attr('title', "Speed : " + speed + " Kms/Hr");
                            this.cells[5].innerHTML = "<span class='text-red' title='" + speed + " Km/Hr'> <b>" + speed + "</b> </span>";
                        }

                        try {
                            var date = updatedata.split(" ")[0];
                            var time = updatedata.split(" ")[1];
                            var datevalues = new Array();
                            var timevalues = new Array();
                            datevalues = date.split('/');
                            timevalues = time.split(':');
                            var updatetime = new Date(datevalues[2], datevalues[1] - 1, datevalues[0], timevalues[0], timevalues[1], timevalues[2]);
                            todaydate = ServerDt;
                            var _MS_PER_DAY = 86400000;
                            var _MS_PER_aaa = 3600000;
                            var _MS_PER_sss = 60000;
                            var _MS_PER_ddd = 1000;
                            var days = Math.floor((todaydate - updatetime) / _MS_PER_DAY);
                            var hours = Math.floor((todaydate - updatetime) / _MS_PER_aaa);
                            if (hours > 24) {
                                hours = hours % 24;
                            }
                            var min = Math.floor((todaydate - updatetime) / _MS_PER_sss);
                            if (min > 60) {
                                min = min % 60;
                            }
                            var sec = Math.floor((todaydate - updatetime) / _MS_PER_ddd);
                            if (sec > 60) {
                                sec = sec % 60;
                            }
                            var timestamp;
                            if (days >= 1) {
                                var updateicon = vehicle.closest('tr').find('#imgdata');
                                updateicon.attr("src", "../LiveIcons/nodataavail.png");
                                updateicon.attr('title', "There was no Update form " + days + " days " + hours + " Hrs " + min + " Min");
                                timestamp = "No Update form " + days + " days " + hours + " Hrs " + min + " Min";
                            }
                            else if (hours > 1) {
                                var updateicon = vehicle.closest('tr').find('#imgdata');
                                updateicon.attr("src", "../LiveIcons/MoreDelay.png");
                                updateicon.attr('title', "There was no Update form " + hours + " Hrs " + min + " Min");
                                timestamp = "No Update form " + hours + " Hrs " + min + " Min";
                            }
                            else if (min < 10) {
                                var updateicon = vehicle.closest('tr').find('#imgdata');
                                updateicon.attr("src", "../LiveIcons/nodelay.png");
                                updateicon.attr('title', min + " Min " + sec + " Sec Back ");
                                timestamp = min + " Min " + sec + " Sec Back Update";
                            }
                            else if (days < 1) {
                                var updateicon = vehicle.closest('tr').find('#imgdata');
                                updateicon.attr("src", "../LiveIcons/halfdelay.png");
                                updateicon.attr('title', "No Update form " + hours + " Hrs " + min + " Min");
                                timestamp = "There is no Update form " + hours + " Hrs " + min + " Min";
                            }
                            if (min > 30 || hours >= 1 || days >= 1) {
                                this.cells[4].innerHTML = "<span class='text-red' title='" + timestamp + "'> " + timestamp + " </span>";
                            }
                            else {
                                this.cells[4].innerHTML = "<span class='text-green' title='" + timestamp + "'> " + timestamp + " </span>";
                            }
                            this.cells[6].innerHTML = '<b>' + todaymileage + '</b>';
                        }
                        catch (Error) {
                        }

                    }
                }
            });
            runningvehicles = [];
            stoppedvehicles = [];
            delayvehicles = [];


            vehiclenos = [];
            var delayvehiclenos = [];
            for (var i = 0; i < allvehsdata.length; i++) {
                var vehisrgstrd = false;
                for (var veh in livedata) {
                    var updatedata = livedata[veh].Datetime;
                    var date = updatedata.split(" ")[0];
                    var time = updatedata.split(" ")[1];
                    var datevalues = new Array();
                    var timevalues = new Array();
                    datevalues = date.split('/');
                    timevalues = time.split(':');
                    var updatetime = new Date(datevalues[2], datevalues[1] - 1, datevalues[0], timevalues[0], timevalues[1], timevalues[2]);
                    var todaydate = new Date();
                    var _MS_PER_DAY = 86400000;
                    var _MS_PER_aaa = 3600000;
                    var _MS_PER_sss = 60000;
                    var _MS_PER_ddd = 1000;
                    var days = Math.floor((todaydate - updatetime) / _MS_PER_DAY);
                    var hours = Math.floor((todaydate - updatetime) / _MS_PER_aaa);
                    if (hours > 24) {
                        hours = hours % 24;
                    }
                    var min = Math.floor((todaydate - updatetime) / _MS_PER_sss);
                    if (min > 60) {
                        min = min % 60;
                    }
                    var sec = Math.floor((todaydate - updatetime) / _MS_PER_ddd);
                    if (sec > 60) {
                        sec = sec % 60;
                    }
                    if (allvehsdata[i].vehicleno == livedata[veh].vehiclenum) {
                        vehisrgstrd = true;
                        if (min > 30 || hours >= 1 || days >= 1) {
                            if (vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1) {
                                vehiclenos.push(allvehsdata[i].vehicleno);
                                delayvehiclenos.push(allvehsdata[i].vehicleno);
                                delayvehicles.push({ idvehicle_properties: allvehsdata[i].vehicleno, vehicleno: allvehsdata[i].vehicleno, vehicletype: allvehsdata[i].vehicletype, vehicletag: allvehsdata[i].vehicletag });
                            }
                        }
                    }
                }
                if (!vehisrgstrd && vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1) {
                    delayvehicles.push({ idvehicle_properties: allvehsdata[i].vehicleno, vehicleno: allvehsdata[i].vehicleno, vehicletype: allvehsdata[i].vehicletype, vehicletag: allvehsdata[i].vehicletag });
                    vehiclenos.push(allvehsdata[i].vehicleno);
                }
            }
            vehiclenos = [];
            for (var i = 0; i < allvehsdata.length; i++) {
                if (vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1 && delayvehiclenos.indexOf(allvehsdata[i].vehicleno) == -1) {
                    for (var veh in livedata) {
                        if (allvehsdata[i].vehicleno == livedata[veh].vehiclenum && livedata[veh].Speed > 0) {
                            vehiclenos.push(allvehsdata[i].vehicleno);
                            runningvehicles.push({ idvehicle_properties: allvehsdata[i].vehicleno, vehicleno: allvehsdata[i].vehicleno, vehicletype: allvehsdata[i].vehicletype, vehicletag: allvehsdata[i].vehicletag });
                        }
                    }
                }
            }

            var vehiclenos = [];
            for (var i = 0; i < allvehsdata.length; i++) {
                if (vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1 && delayvehiclenos.indexOf(allvehsdata[i].idvehicle_properties) == -1) {
                    for (var veh in livedata) {
                        if (allvehsdata[i].vehicleno == livedata[veh].vehiclenum && livedata[veh].Speed == 0) {
                            vehiclenos.push(allvehsdata[i].vehicleno);
                            stoppedvehicles.push({ idvehicle_properties: allvehsdata[i].vehicleno, vehicleno: allvehsdata[i].vehicleno, vehicletype: allvehsdata[i].vehicletype, vehicletag: allvehsdata[i].vehicletag });
                        }
                    }
                }
            }

            $('#lbl_runningdevices').html(runningvehicles.length);
            $('#lbl_stoppeddevices').html(stoppedvehicles.length);
            $('#lbl_delaydevices').html(delayvehicles.length);
//////            if (!isgridinit) {
//////                isgridinit = true;
//////                $('#tbl_vehicles').DataTable({
//////                    paging: false,
//////                    searching: false
//////                });
//////            }
            if ($('#spn_showhideaddress').find('label').html() == "Hide Address") {
                getdashboardaddresses();
            }
            cntforaddrs = 0;
        }

        function showhideaddress(thisid) {
            if ($(thisid).find('label').html() == "Show Address") {
                getdashboardaddresses();
                $(thisid).find('label').html("Hide Address");
            } else {
                liveupdate();
                $(thisid).find('label').html("Show Address");
            }
            cntforaddrs = 0;
        }

        var cntforaddrs = 0;
        function getdashboardaddresses() {
            var data = livedata;
            var vehicleid = data[cntforaddrs].vehiclenum;
            var vehicleno = data[cntforaddrs].vehiclenum;
            var vehicle = $('#VehiclesTable').find("#" + data[cntforaddrs].vehiclenum + "");
            var mainpower = data[cntforaddrs].mainpower;
            var latitude = data[cntforaddrs].latitude;
            var longitude = data[cntforaddrs].longitude;
            var angle = data[cntforaddrs].direction;
            var updatedata = data[cntforaddrs].Datetime;
            var speed = data[cntforaddrs].Speed;
            var odometervalue = data[cntforaddrs].odometervalue;
            var gps = data[cntforaddrs].GPSSignal;
            var geofence = data[cntforaddrs].Geofence;
            var todaymileage = data[cntforaddrs].todaymileage;
            var dieselstring = data[cntforaddrs].dieselvalue;
            var fulltankval = data[cntforaddrs].fulltankval;

            var locpoint = new google.maps.LatLng(latitude, longitude);
            var address = "No Results";
            geocoder = new google.maps.Geocoder();
            address = geocoder.geocode({ 'latLng': locpoint }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    if (results.length > 0) {
                        if (results[0]) {
                            address = results[0].formatted_address;
                            $("#tbl_vehicles").find('tr#' + vehicleid).find('td').eq(7).text(address);
                            if (livedata.length - 1 > cntforaddrs) {
                                cntforaddrs++;
                                getdashboardaddresses();
                            }
                        }
                        else {
                            address = "No Results";
                            $("#tbl_vehicles").find('tr#' + vehicleid).find('td').eq(7).text(address);
                            if (livedata.length - 1 > cntforaddrs) {
                                cntforaddrs++;
                                getdashboardaddresses();
                            }
                        }
                    }
                    else {
                        address = "No Results";
                        $("#tbl_vehicles").find('tr#' + vehicleid).find('td').eq(7).text(address);
                        if (livedata.length - 1 > cntforaddrs) {
                            cntforaddrs++;
                            getdashboardaddresses();
                        }
                    }
                }
                else {
                    address = "No Results";
                    $("#tbl_vehicles").find('tr#' + vehicleid).find('td').eq(7).text(address);
                    if (livedata.length - 1 > cntforaddrs) {
                        cntforaddrs++;
                        getdashboardaddresses();
                    }
                }
            });
        }

        var hidden = true;
        $(function () {
            $("#a_filtertoggle").click(function () {
                if (hidden) {
                    $("#filters-sidebar").stop().animate({ left: 0 }, 100);
                    hidden = false;
                }
                else {
                    $("#filters-sidebar").css('margin-left', 0);
                    $("#filters-sidebar").css('margin-right', 0);
                    $("#filters-sidebar").animate({ left: '-300px' }, 300);
                    hidden = true;
                }
            });
        });

        function clearalldata() {
            $('#datagrid').html('');
            deleteOverlays();
            $('#lbl_moving_time').html('0H 0Min');
            $('#lbl_stoppage_time').html('0H 0Min');
            $('#lbl_idling_time').html('0H 0Min');
            $('#lbl_moving_time_1').html('0H 0Min');
            $('#lbl_stoppage_time_1').html('0H 0Min');
            $('#lbl_idling_time_1').html('0H 0Min');
            $('#lbl_map_vehicle').html('Vehicle');
            $("#knob_moving").val(0);
            $("#knob_stopped").val(0);
            $("#knob_idle").val(0);
            //$('.knob').trigger('change');

            $("#line-chart").html("");
            $("#distance-chart").html("");
            $("#pieChart").html("");

            //-------------
            //- PIE CHART -
            //-------------
            // Get context with jQuery - using jQuery's .get() method.
////////            var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
////////            var pieChart = new Chart(pieChartCanvas);
////////            var PieData = [
////////              {
////////                  value: 0,
////////                  color: "",
////////                  highlight: "",
////////                  label: ""
////////              }
////////            ];
////////            var pieOptions = {
////////                //Boolean - Whether we should show a stroke on each segment
////////                segmentShowStroke: true,
////////                //String - The colour of each segment stroke
////////                segmentStrokeColor: "#fff",
////////                //Number - The width of each segment stroke
////////                segmentStrokeWidth: 1,
////////                //Number - The percentage of the chart that we cut out of the middle
////////                percentageInnerCutout: 50, // This is 0 for Pie charts
////////                //Number - Amount of animation steps
////////                animationSteps: 100,
////////                //String - Animation easing effect
////////                animationEasing: "easeOutBounce",
////////                //Boolean - Whether we animate the rotation of the Doughnut
////////                animateRotate: true,
////////                //Boolean - Whether we animate scaling the Doughnut from the centre
////////                animateScale: false,
////////                //Boolean - whether to make the chart responsive to window resizing
////////                responsive: true,
////////                // Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
////////                maintainAspectRatio: false,
////////                //String - A legend template
////////                legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>",
////////                //String - A tooltip template
////////                tooltipTemplate: "<%=value %> <%=label%>"
////////            };
////////            //Create pie or douhnut chart
////////            // You can switch between pie and douhnut using the method below.
////////            pieChart.Doughnut(PieData, pieOptions);
            //-----------------
            //- END PIE CHART -
            //-----------------

        }

        function a_vehicles_moreinfo(gettype) {
            vehiclenos = [];
            isgridinit = false;
            clearalldata();
            if (gettype == "all") {
                var clientdivs = "";
                clientdivs = '<div class="box box-success"> <div class="box-header with-border"><i class="fa fa-car"></i><h3 class="box-title">Vehicles</h3> <div class="box-tools pull-right"><span class="label label-danger" style="cursor: pointer;margin-right: 5px;" id="spn_showhideaddress" onclick="showhideaddress(this);"><label style="width: 70px;cursor: pointer;">Show Address</label><button type="button" class="btn btn-box-tool" style="color: #fff; font-size: 13px;"><i class="fa fa-map-marker"></i></button></span><span class="label label-success" style="cursor: pointer;" onclick="liveupdate();">Refresh <button type="button" class="btn btn-box-tool" data-widget="refresh" title="Refresh" style="color: #fff; font-size: 13px;"> <i class="fa fa-refresh"></i> </button></span><button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-minus"></i> </button> </div></div><div class="box-body"> <div class="table-responsive"> <table class="table no-margin" id="tbl_vehicles"><thead><tr><th>SNo</th><th>Vehicle Number</th><th>Vehicle Type</th><th>Main Power</th><th>Update Status</th><th>Speed (Km/Hr)</th><th>Today Mileage (KMs)</th><th>Address</th></tr></thead><tbody>';
                var cnt = 1;
                for (var i = 0; i < allvehsdata.length; i++) {
                    if (vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1) {
                        clientdivs += '<tr id=' + allvehsdata[i].vehicleno + ' onclick="onvehrow_click(this);" style="cursor:pointer;"><td>' + cnt + '</td><td><a>' + allvehsdata[i].vehicleno + '</a></td><td>' + allvehsdata[i].vehicletype + '</td><td><span class="text-red" title="OFF"><i class="fa fa-power-off"></i> <b>OFF</b> </span><td> </td><td> <b>0</b> </td><td><b>0 Kms</b></td><td> </td></tr>';
                        vehiclenos.push(allvehsdata[i].vehicleno);
                        cnt++;
                    }
                }
                clientdivs += '</tbody></table></div></div></div>';
                $('#datagrid').append(clientdivs);

                liveupdate();
            }
            else if (gettype == "running") {
                var clientdivs = "";
                clientdivs = '<div class="box box-success"> <div class="box-header with-border"><i class="fa fa-car"></i><h3 class="box-title">Vehicles</h3> <div class="box-tools pull-right"><span class="label label-danger" style="cursor: pointer;margin-right: 5px;" id="spn_showhideaddress" onclick="showhideaddress(this);"><label style="width: 70px;cursor: pointer;">Show Address</label><button type="button" class="btn btn-box-tool" style="color: #fff; font-size: 13px;"><i class="fa fa-map-marker"></i></button></span><span class="label label-success" style="cursor: pointer;" onclick="liveupdate();">Refresh <button type="button" class="btn btn-box-tool" data-widget="refresh" title="Refresh" style="color: #fff; font-size: 13px;"> <i class="fa fa-refresh"></i> </button></span><button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-minus"></i> </button> </div></div><div class="box-body"> <div class="table-responsive"> <table class="table no-margin" id="tbl_vehicles"><thead><tr><th>SNo</th><th>Vehicle Number</th><th>Vehicle Type</th><th>Main Power</th><th>Update Status</th><th>Speed (Km/Hr)</th><th>Today Mileage (KMs)</th><th>Address</th></tr></thead><tbody>';
                var cnt = 1;
                for (var i = 0; i < allvehsdata.length; i++) {
                    for (var j = 0; j < runningvehicles.length; j++) {
                        if (allvehsdata[i].vehicleno == runningvehicles[j].idvehicle_properties) {
                            if (vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1) {
                                clientdivs += '<tr id=' + allvehsdata[i].vehicleno + ' onclick="onvehrow_click(this);" style="cursor:pointer;"><td>' + cnt + '</td><td><a>' + allvehsdata[i].vehicleno + '</a></td><td>' + allvehsdata[i].vehicletype + '</td><td><span class="text-red" title="OFF"><i class="fa fa-power-off"></i> <b>OFF</b> </span><td> </td><td> <b>0</b> </td><td><b>0 Kms</b></td><td> </td></tr>';
                                vehiclenos.push(allvehsdata[i].vehicleno);
                                cnt++;
                            }
                        }
                    }
                }
                clientdivs += '</tbody></table></div></div></div>';
                $('#datagrid').append(clientdivs);

                liveupdate();
            }
            else if (gettype == "stopped") {
                var clientdivs = "";
                clientdivs = '<div class="box box-success"> <div class="box-header with-border"><i class="fa fa-car"></i><h3 class="box-title">Vehicles</h3> <div class="box-tools pull-right"><span class="label label-danger" style="cursor: pointer;margin-right: 5px;" id="spn_showhideaddress" onclick="showhideaddress(this);"><label style="width: 70px;cursor: pointer;">Show Address</label><button type="button" class="btn btn-box-tool" style="color: #fff; font-size: 13px;"><i class="fa fa-map-marker"></i></button></span><span class="label label-success" style="cursor: pointer;" onclick="liveupdate();">Refresh <button type="button" class="btn btn-box-tool" data-widget="refresh" title="Refresh" style="color: #fff; font-size: 13px;"> <i class="fa fa-refresh"></i> </button></span><button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-minus"></i> </button> </div></div><div class="box-body"> <div class="table-responsive"> <table class="table no-margin" id="tbl_vehicles"><thead><tr><th>SNo</th><th>Vehicle Number</th><th>Vehicle Type</th><th>Main Power</th><th>Update Status</th><th>Speed (Km/Hr)</th><th>Today Mileage (KMs)</th><th>Address</th></tr></thead><tbody>';
                var cnt = 1;
                for (var i = 0; i < allvehsdata.length; i++) {
                    for (var j = 0; j < stoppedvehicles.length; j++) {
                        if (allvehsdata[i].vehicleno == stoppedvehicles[j].idvehicle_properties) {
                            if (vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1) {
                                clientdivs += '<tr id=' + allvehsdata[i].vehicleno + ' onclick="onvehrow_click(this);" style="cursor:pointer;"><td>' + cnt + '</td><td><a>' + allvehsdata[i].vehicleno + '</a></td><td>' + allvehsdata[i].vehicletype + '</td><td><span class="text-red" title="OFF"><i class="fa fa-power-off"></i> <b>OFF</b> </span><td> </td><td> <b>0</b> </td><td><b>0 Kms</b></td><td> </td></tr>';
                                vehiclenos.push(allvehsdata[i].vehicleno);
                                cnt++;
                            }
                        }
                    }
                }
                clientdivs += '</tbody></table></div></div></div>';
                $('#datagrid').append(clientdivs);

                liveupdate();
            }
            else if (gettype == "delayupdate") {
                var clientdivs = "";
                clientdivs = '<div class="box box-success"> <div class="box-header with-border"><i class="fa fa-car"></i><h3 class="box-title">Vehicles</h3> <div class="box-tools pull-right"><span class="label label-danger" style="cursor: pointer;margin-right: 5px;" id="spn_showhideaddress" onclick="showhideaddress(this);"><label style="width: 70px;cursor: pointer;">Show Address</label><button type="button" class="btn btn-box-tool" style="color: #fff; font-size: 13px;"><i class="fa fa-map-marker"></i></button></span><span class="label label-success" style="cursor: pointer;" onclick="liveupdate();">Refresh <button type="button" class="btn btn-box-tool" data-widget="refresh" title="Refresh" style="color: #fff; font-size: 13px;"> <i class="fa fa-refresh"></i> </button></span><button type="button" class="btn btn-box-tool" data-widget="collapse"> <i class="fa fa-minus"></i> </button> </div></div><div class="box-body"> <div class="table-responsive"> <table class="table no-margin" id="tbl_vehicles"><thead><tr><th>SNo</th><th>Vehicle Number</th><th>Vehicle Type</th><th>Main Power</th><th>Update Status</th><th>Speed (Km/Hr)</th><th>Today Mileage (KMs)</th><th>Address</th></tr></thead><tbody>';
                var cnt = 1;
                for (var i = 0; i < allvehsdata.length; i++) {
                    for (var j = 0; j < delayvehicles.length; j++) {
                        if (allvehsdata[i].vehicleno == delayvehicles[j].idvehicle_properties) {
                            if (vehiclenos.indexOf(allvehsdata[i].vehicleno) == -1) {
                                clientdivs += '<tr id=' + allvehsdata[i].vehicleno + ' onclick="onvehrow_click(this);" style="cursor:pointer;"><td>' + cnt + '</td><td><a>' + allvehsdata[i].vehicleno + '</a></td><td>' + allvehsdata[i].vehicletype + '</td><td><span class="text-red" title="OFF"><i class="fa fa-power-off"></i> <b>OFF</b> </span><td> </td><td> <b>0</b> </td><td><b>0 Kms</b></td><td> </td></tr>';
                                vehiclenos.push(allvehsdata[i].vehicleno);
                                cnt++;
                            }
                        }
                    }
                }
                clientdivs += '</tbody></table></div></div></div>';
                $('#datagrid').append(clientdivs);

                liveupdate();
            }
        }
    </script>
</head>
<body class="hold-transition skin-blue layout-top-nav">
    <div class="wrapper">
        <header class="main-header">
            <nav class="navbar navbar-static-top">
               <div class="container" style="width: 100%;">
                <div class="navbar-header" style="width: 21%;">
                    <a class="navbar-brand"><span style="font-size: 40px;">GoTracking</span></a>
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                        <i class="fa fa-bars"></i>
                    </button>
                   <!-- <a style="background: none repeat scroll 0 0 rgba(0, 0, 0, 0.3); border-radius: 3px;
                        color: rgba(255, 255, 255, 0.8); cursor: pointer; display: block; height: 15px;
                        position: absolute; padding-bottom: 31px; top: 9.5%; left: 17%;" class="sidebar-toggle"
                        data-toggle="control-sidebar" role="button"><span class="sr-only">Toggle navigation</span>
                    </a>-->
                </div>
                <div id="nt-title-container" class="navbar-left running-text visible-lg" style="padding: 0px 0px 0 10px !important;
                    margin: 0px !important; background: none repeat scroll 0 0 rgba(0, 0, 0, 0.2);
                    border: 1px solid rgba(0, 0, 0, 0.2); border-radius: 30px; box-shadow: 0 1px 0 rgba(255, 255, 255, 0.1);
                    color: #FFFFFF; width: 79%;">
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">
                           <li class="dropdown"><i class="fa fa-stop-circle-o" style="top:36%;position:absolute;" ></i><a style="cursor: pointer;padding-left:22%;"  href="index.html">Liveview</a></li>
                            <li class="dropdown"><a style="cursor: pointer;" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-tasks" aria-hidden="true"></i>&nbsp Manage <span class="caret"></span>
                            </a>
                                <ul style="margin: 11px 0px 0px 9px; position: absolute; left: 0px; top: 46px;" role="menu"
                                    class="dropdown-menu dropdown-wrap">
                                    <li><a style="cursor: pointer;" href="Locations.html">
                                        <img alt="" class="img-msg img-circle" src="img/location.png">My Locations</a></li>
                                    <li class="divider"></li>
                                    <li><a style="cursor: pointer;" href="VehicleGrouping.html">
                                        <img alt="" class="img-msg img-circle" src="img/vehicle2.jpg">Vehicle Groups</a></li>
                                    <li class="divider"></li>
                                    <li><a style="cursor: pointer;" href="PersonDetails.html">
                                        <img alt="" class="img-msg img-circle" src="img/person.png">Person Details</a></li>
                                    <li class="divider"></li>
                                    <li><a style="cursor: pointer;" href="AlertGroups.html">
                                        <img alt="" class="img-msg img-circle" src="img/alerts.jpg">Alert Groups</a></li>
                                    <li class="divider"></li>
                                    <li><a style="cursor: pointer;" href="AssignAlerts.html">
                                        <img alt="" class="img-msg img-circle" src="img/alerts.jpg">Assign Alerts</a></li>
                                    <li class="divider"></li>
                                    <li><a style="cursor: pointer;" href="ChangePassword.html">
                                        <div>
                                            Change Password</div>
                                    </a></li>
                                </ul>
                            </li>
                            <li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle"><i class="fa fa-tasks"
                                aria-hidden="true"></i>&nbsp Reports <span class="caret"></span></a>
                                <ul style="margin: 11px 0px 0px 9px; position: absolute; left: 0px; top: 46px;" role="menu"
                                    class="dropdown-menu dropdown-wrap">
                                    <li style="height: 28px; width: 233px;">
                                        <div style="width: 100%;">
                                            <div style="width: 14%; float: left; padding-left: 20px;">
                                                <img alt="" class="img-msg img-circle" src="img/report2.jpg" />
                                            </div>
                                            <div style="width: 85%; float: right;">
                                                <a style="cursor: pointer;" href="index.html" onclick="changepage(this);">General Report</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="divider"></li>
                                    <li style="height: 30px;">
                                        <div style="width: 100%;">
                                            <div style="width: 14%; float: left; padding-left: 20px; padding-top: 2px;">
                                                <img alt="" class="img-msg img-circle" src="img/stop.png">
                                            </div>
                                            <div style="width: 85%; float: right; padding-top: 5px;">
                                                <a style="cursor: pointer;" href="index.html" onclick="changepage(this);">Stopage Report</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="divider"></li>
                                    <li style="height: 30px;">
                                        <div style="width: 100%;">
                                            <div style="width: 14%; float: left; padding-left: 20px; padding-top: 2px;">
                                                <img alt="" class="img-msg img-circle" src="img/overspeed.png">
                                            </div>
                                            <div style="width: 85%; float: right; padding-top: 5px;">
                                                <a style="cursor: pointer;" href="index.html" onclick="changepage(this);">OverSpeed Report</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="divider"></li>
                                    <li style="height: 30px;">
                                        <div style="width: 100%;">
                                            <div style="width: 14%; float: left; padding-left: 20px; padding-top: 2px;">
                                                <img alt="" class="img-msg img-circle" src="img/daily.jpg">
                                            </div>
                                            <div style="width: 85%; float: right; padding-top: 5px;">
                                                <a style="cursor: pointer;" href="index.html" onclick="changepage(this);">Daily Report</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="divider"></li>
                                    <li style="height: 30px;">
                                        <div style="width: 100%;">
                                            <div style="width: 14%; float: left; padding-left: 20px; padding-top: 2px;">
                                                <img alt="" class="img-msg img-circle" src="img/timetostop.jpg">
                                            </div>
                                            <div style="width: 85%; float: right; padding-top: 5px;">
                                                <a style="cursor: pointer;" href="index.html" onclick="changepage(this);">Location HaltingHours Report</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="divider"></li>
                                    <li style="height: 30px;">
                                        <div style="width: 100%;">
                                            <div style="width: 14%; float: left; padding-left: 20px; padding-top: 2px;">
                                                <img alt="" class="img-msg img-circle" src="img/location.png">
                                            </div>
                                            <div style="width: 85%; float: right; padding-top: 5px;">
                                                <a style="cursor: pointer;" href="index.html" onclick="changepage(this);">Location to Location Report</a>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="divider"></li>
                                    <li style="height: 30px;">
                                        <div style="width: 100%;">
                                            <div style="width: 14%; float: left; padding-left: 20px; padding-top: 2px;">
                                                <img alt="" class="img-msg img-circle" src="img/reports.jpg">
                                            </div>
                                            <div style="width: 85%; float: right; padding-top: 5px;">
                                                <a style="cursor: pointer;" href="index.html" onclick="changepage(this);">Ignition Report</a>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li><a style="cursor: pointer;" href="Nearbyvehicles.html"><i class="fa fa-map-marker"
                                aria-hidden="true"></i>&nbsp Get Nearest Vehicles</a></li>
                            <li><a style="cursor: pointer; padding-left: 211px;" href="#"></a></li>
                            <!--    alerts total vehicle count-->
                            <!--<li class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle" href="#"><i
                                style="font-size: 20px;" class="fa fa-comments" aria-hidden="true"></i>
                                <div class="noft-red">
                                    <span id="lblvehscount">0</span></div>
                            </a>
                                <ul style="margin: 11px 0px 0px 9px; position: absolute; left: 0px; top: 48px;" role="menu"
                                    class="dropdown-menu dropdown-wrap" id="ul_showallvehs">
                                </ul>
                            </li>
                            <li><a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="fa fa-exclamation-triangle"
                                style="font-size: 19px;" aria-hidden="true"></i>
                                <div class="noft-green">
                                    <span id="icon_notworkingvehicles">0</span></div>
                            </a>
                                <ul style="margin: 12px 0px 0px; position: absolute; left: 0px; top: 48px;" role="menu"
                                    class="dropdown-menu dropdown-wrap" id="ul_shownonworkingvehs">
                                </ul>
                            </li>
                            <li><a data-toggle="dropdown" class="dropdown-toggle" href="#"><i class="fa fa-check-square-o"
                                style="font-size: 19px;" aria-hidden="true"></i>
                                <div class="noft-green">
                                    <span id="icon_workingvehicles">0</span></div>
                            </a>
                                <ul style="margin: 12px 0px 0px; position: absolute; left: 0px; top: 48px;" role="menu"
                                    class="dropdown-menu dropdown-wrap" id="ul_showworkingvehs">
                                </ul>
                            </li>-->
                            <!-- /.total vehicle count -->
                        </ul>
                    </div>
                    <!-- /.navbar-collapse -->
                    <!-- Navbar Right Menu -->
                    <div class="navbar-custom-menu">
                        <ul class="nav navbar-nav">
                            <!-- Messages: style can be found in dropdown.less-->
                            <li class="dropdown messages-menu" style="display: none;">
                                <!-- Menu toggle button -->
                                <a style="cursor: pointer;" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-taxi">
                                </i><span class="label label-default" id="lblvehscount">0</span> </a>
                                <ul class="dropdown-menu">
                                    <li class="header">Total Vehicles <span class="label label-default" id="lblvehscount1">
                                    </span></li>
                                    <li>
                                        <!-- inner menu: contains the messages -->
                                        <ul class="menu" id="ul_showallvehs">
                                        </ul>
                                        <!-- /.menu -->
                                    </li>
                                </ul>
                            </li>
                            <!-- /.messages-menu -->
                            <!-- Notifications Menu -->
                            <li class="dropdown messages-menu" style="display: none;">
                                <!-- Menu toggle button -->
                                <a style="cursor: pointer;" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-check-square-o">
                                </i><span class="label label-success" id="icon_workingvehicles">0</span> </a>
                                <ul class="dropdown-menu">
                                    <li class="header">Working Vehicles <span class="label label-success" id="icon_workingvehicles1">
                                    </span></li>
                                    <li>
                                        <!-- inner menu: contains the messages -->
                                        <ul class="menu" id="ul_showworkingvehs">
                                        </ul>
                                        <!-- /.menu -->
                                    </li>
                                </ul>
                            </li>
                            <!-- Tasks Menu -->
                            <li class="dropdown messages-menu" style="display: none;">
                                <!-- Menu Toggle Button -->
                                <a style="cursor: pointer;" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-ban">
                                </i><span class="label label-danger" id="icon_notworkingvehicles">0</span> </a>
                                <ul class="dropdown-menu">
                                    <li class="header">Not Working Vehicles <span class="label label-danger" id="icon_notworkingvehicles1">
                                    </span></li>
                                    <li>
                                        <!-- inner menu: contains the messages -->
                                        <ul class="menu" id="ul_shownonworkingvehs">
                                        </ul>
                                        <!-- /.menu -->
                                    </li>
                                </ul>
                            </li>
                            <!-- User Account Menu -->
                            <li class="dropdown user user-menu">
                                <!-- Menu Toggle Button -->
                                <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                    <img alt="" class="admin-pic img-circle" src="dist/img/avatar5.png" height="25px"
                                        width="25px">&nbsp Hi, <span id="lbl_username"></span><b class="caret"></b>
                                </a>
                                <ul style="margin-top: 0px;" role="menu" class="dropdown-setting dropdown-menu">
                                   <!-- <li><a href="#"><span class="entypo-user"></span>&nbsp;&nbsp;My Profile</a> </li>
                                    <li><a href="#"><span class="entypo-vcard"></span>&nbsp;&nbsp;Account Setting</a>
                                    </li>
                                    <li><a href="#"><span class="entypo-lifebuoy"></span>&nbsp;&nbsp;Help</a> </li>-->
                                    <li class="divider"></li>
                                    <li id="logout_click"><a><span class="entypo-basket"></span>&nbsp;&nbsp; Sign Out</a>
                                    </li>
                                </ul>
                        </ul>
                    </div>
                    <!-- /.navbar-custom-menu -->
                </div>
            </div>
            </nav>
        </header>
        <!-- Full Width Column -->
        <div class="content-wrapper">
            <section class="content">
                <div class="row">
                    <div class="col-lg-3 col-xs-6">
                        <!-- small box -->
                        <div class="small-box bg-aqua">
                            <div class="inner">
                                <h3 id="lbl_totdevices">0</h3>
                                <p>Total Vehicles</p>
                            </div>
                            <div class="icon">
                                <i class="fa fa-car"></i>
                            </div>
                            <a href="#datagrid" class="small-box-footer" onclick="a_vehicles_moreinfo('all');">More info <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                    <!-- ./col -->
                    <div class="col-lg-3 col-xs-6">
                        <!-- small box -->
                        <div class="small-box bg-green">
                            <div class="inner">
                                <h3 id="lbl_runningdevices">0</h3>
                                <p>Running Vehicles</p>
                            </div>
                            <div class="icon">
                                <i class="fa fa-play-circle"></i>
                            </div>
                            <a href="#datagrid" class="small-box-footer" onclick="a_vehicles_moreinfo('running');">More info <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                    <!-- ./col -->
                    <div class="col-lg-3 col-xs-6">
                        <!-- small box -->
                        <div class="small-box bg-yellow">
                            <div class="inner">
                                <h3 id="lbl_stoppeddevices">0</h3>
                                <p>Stopped Vehicles</p>
                            </div>
                            <div class="icon">
                                <i class="fa fa-stop-circle"></i>
                            </div>
                            <a href="#datagrid" class="small-box-footer" onclick="a_vehicles_moreinfo('stopped');">More info <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                    <!-- ./col -->
                    <div class="col-lg-3 col-xs-6">
                        <!-- small box -->
                        <div class="small-box bg-red">
                            <div class="inner">
                                <h3 id="lbl_delaydevices">0</h3>
                                <p>Dealay Update Vehicles</p>
                            </div>
                            <div class="icon">
                                <i class="fa fa-ban"></i>
                            </div>
                            <a href="#datagrid" class="small-box-footer" onclick="a_vehicles_moreinfo('delayupdate');">More info <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                    <!-- ./col -->
                </div>

                <!-- distance graph -->
                <div class="row" id="div_distancegraph">
                    <div class="col-sm-12">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">Today Mileage</h3>
                                <div class="box-tools pull-right">
                                    <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                    <!--<button class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>-->
                                </div>
                            </div>
                            <div class="box-body">
                               <!-- <div class="chart">
                                    <canvas id="barChart" style="height:300px"></canvas>
                                </div>-->
                                <div id="chartdiv"></div>
                            </div><!-- /.box-body -->
                        </div><!-- /.box -->
                    </div>
                </div>

                <!--vehicle graphs-->
                <div class="row" id="div_vehicle_graphs">
                    <div class="col-sm-4">
                        <!-- solid speed graph -->
                        <div class="box box-solid bg-light-blue-gradient">
                            <div class="box-header">
                                <i class="fa fa-dashboard"></i>
                                <h3 class="box-title">Speed Graph</h3>
                                <div class="box-tools pull-right">
                                    <button class="btn bg-light-blue btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                </div>
                            </div>
                            <div class="box-body border-radius-none">
                                <div class="chart" id="line-chart" style="height: 250px;"></div>
                            </div><!-- /.box-body -->
                       
                        </div><!-- /.box -->
                    </div>
                    <div class="col-sm-4">
                        <!-- solid distance graph -->
                        <div class="box box-solid bg-aqua-gradient">
                            <div class="box-header">
                                <i class="fa fa-dashboard"></i>
                                <h3 class="box-title">Distance Graph</h3>
                                <div class="box-tools pull-right">
                                    <button class="btn bg-aqua btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                </div>
                            </div>
                            <div class="box-body border-radius-none">
                                <div class="chart" id="distance-chart" style="height: 250px;"></div>
                            </div><!-- /.box-body -->

                        </div><!-- /.box -->
                    </div>
                    <div class="col-sm-4">
                            <div class="box">
                                <div class="box-header with-border">
                                    <i class="fa fa-pie-chart"></i>
                                    <h3 class="box-title">Vehicle Usage</h3>
                                    <div class="box-tools pull-right">
                                        <button class="btn btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                    </div>
                                </div><!-- /.box-header -->
                                <div class="box-body" style="padding-bottom:2px;">
                                    <div class="row">
                                        <div class="col-md-8">
                                           <div class="chart-responsive" style="height:200px;">
                                                 <div id="pieChart"></div>
                                           </div>
                                        </div><!-- /.col -->
                                        <div class="col-md-4">
                                            <ul class="chart-legend clearfix" style="color:#000;">
                                                <li style="margin: 0 0 10px 0;"><i class="fa fa-circle-o text-green"></i> Moving</li>
                                                <li style="margin: 0 0 10px 0;"><i class="fa fa-circle-o text-red"></i> Stoppage</li>
                                                <li style="margin: 0 0 10px 0;"><i class="fa fa-circle-o text-yellow"></i> Idling</li>
                                            </ul>
                                        </div><!-- /.col -->
                                    </div><!-- /.row -->
                                    <div class="row">
                                        <ul class="nav nav-pills nav-stacked">
                                            <li><a>Moving <span id="lbl_moving_time_1" class="pull-right text-green"><b> 0H 0Min</b></span></a></li>
                                            <li><a>Stoppage <span id="lbl_stoppage_time_1" class="pull-right text-red"><b> 0H 0Min</b></span></a></li>
                                            <li><a>Idling <span id="lbl_idling_time_1" class="pull-right text-yellow"><b> 0H 0Min</b></span></a></li>
                                        </ul>
                                    </div><!-- /.row -->
                                </div><!-- /.box-body -->
                            </div><!-- /.row -->
                    </div>
                </div>
                    <!-- vehicles grid -->
                    <div class="row">
                        <div class="col-sm-4" style="padding:0px;">
                            <section class="col-lg-12 connectedSortable ui-sortable">
                                <!-- Map box -->
                                <div class="box box-solid bg-light-blue-gradient">
                                    <div class="box-header ui-sortable-handle" style="cursor: move;">
                                        <!-- tools box -->
                                        <div class="pull-right box-tools">
                                            <button type="button" class="btn btn-primary btn-sm pull-right" data-widget="collapse" data-toggle="tooltip" title="" style="margin-right: 5px;" data-original-title="Collapse">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                        </div>
                                        <!-- /. tools -->

                                        <i class="fa fa-car"></i>
                                        <h3 class="box-title" id="lbl_map_vehicle">
                                            Vehicle
                                        </h3>
                                    </div>
                                    <div class="box-body" style="padding:0px;">
                                        <div id="googleMap" style="top: 0px; bottom: 0px; left: 0px; right: 0px; height: 250px; background-color: rgb(229, 227, 223);">
                                        </div>
                                    </div>
                                    <!-- /.box-body-->
                                    <!--<div class="box-footer no-border">
                                        <div class="row">
                                            <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                                                <div id="sparkline-1" style="display: inline-block; width: 80px; height: 25px; vertical-align: top;">
                                                    <div class="inner">
                                                        <span id="lbl_moving_time" style="color:green;">0H 0Min</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                                                <div id="sparkline-2" style="display: inline-block; width: 80px; height: 25px; vertical-align: top;">
                                                    <span id="lbl_stoppage_time" style="color:red;">0H 0Min</span>
                                                </div>
                                            </div>
                                            <div class="col-xs-4 text-center">
                                                <div id="sparkline-3" style="display: inline-block; width: 80px; height: 25px; vertical-align: top;">
                                                    <span id="lbl_idling_time" style="color:orange;">0H 0Min</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                                                <input id="knob_moving" type="text" class="knob" data-readonly="true" value="0" data-width="60" data-height="60" data-fgColor="#39CCCC">
                                                <div class="knob-label">Moving (%)</div>
                                            </div>
                                            <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                                                <input id="knob_stopped" type="text" class="knob" data-readonly="true" value="0" data-width="60" data-height="60" data-fgColor="#39CCCC">
                                                <div class="knob-label">Stoppage (%)</div>
                                            </div>
                                            <div class="col-xs-4 text-center">
                                                <input id="knob_idle" type="text" class="knob" data-readonly="true" value="0" data-width="60" data-height="60" data-fgColor="#39CCCC">
                                                <div class="knob-label">Idling (%)</div>
                                            </div>
                                        </div>
                                    </div>-->
                                </div>
                            </section>
                        </div>
                        <div class="col-sm-8" id="datagrid">

                        </div>
                    </div>
</section>
        </div><!-- /.content-wrapper -->
    </div> <!-- ./wrapper -->
</body>
</html>
